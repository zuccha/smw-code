<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="../assets/markdown.css" />
  </head>
  <body>
    <div
      data-color-mode="light"
      data-light-theme="light"
      data-dark-theme="dark"
      class="markdown-body"
    >
      <main>
        <div class="navigation">
          <a href="../../README.html">Home</a> |
          <a href="./changelog.html">Changelog</a> |
          <a href="./compatibility.html">Compatibility</a> |
          <a href="./credits.html">Credits</a> |
          <a href="./dynamic_positioning.html">Dynamic positioning</a> |
          <a href="./features.html">Features</a> |
          <a href="./how_to_insert.html">How to insert</a> |
          <a href="./how_to_remove.html">How to remove</a> | How to use
        </div>
        <h1 id="how-to-use">
          <a class="anchor" aria-hidden="true" tabindex="-1" href="#how-to-use"
            ><svg
              class="octicon octicon-link"
              viewBox="0 0 16 16"
              width="16"
              height="16"
              aria-hidden="true"
            >
              <path
                fill-rule="evenodd"
                d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"
              ></path></svg></a
          >How to use
        </h1>
        <p>
          You have different ways of customizing the status bar. After applying
          any change with the methods described below, rerun UberASMTool and you
          are good to go.
        </p>
        <h2 id="1-global-settings">
          <a
            class="anchor"
            aria-hidden="true"
            tabindex="-1"
            href="#1-global-settings"
            ><svg
              class="octicon octicon-link"
              viewBox="0 0 16 16"
              width="16"
              height="16"
              aria-hidden="true"
            >
              <path
                fill-rule="evenodd"
                d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"
              ></path></svg></a
          >1. Global settings
        </h2>
        <p>
          You can change global settings in <code>csb_asm/settings.asm</code>. A
          detailed explanation on what each setting does is provided in the
          file.
        </p>
        <p>
          Global settings are restored any time a level is loaded (from
          overworld, sub-level entrances, fast retry after death,
          <em>etc.</em>), but they can be overridden on a level basis (see next
          section).
        </p>
        <h2 id="2-per-level-customization">
          <a
            class="anchor"
            aria-hidden="true"
            tabindex="-1"
            href="#2-per-level-customization"
            ><svg
              class="octicon octicon-link"
              viewBox="0 0 16 16"
              width="16"
              height="16"
              aria-hidden="true"
            >
              <path
                fill-rule="evenodd"
                d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"
              ></path></svg></a
          >2. Per-level customization
        </h2>
        <p>
          You can override global settings on a level basis. To do this, you
          just need to create an ASM file for the level (or modify an existing
          one) and add code under the <code>load:</code> label.
        </p>
        <p>
          For instance, let&#39;s say we want to enable the timer (globally
          disabled) and customize it for level 105. Then we create file
          <code>level_105.asm</code> in UberASMTool&#39;s
          <code>levels/</code> folder as follows
        </p>
        <div class="highlight highlight-source-asar notranslate">
          <pre>load<span class="token punctuation">:</span>
    <span class="token op-code keyword">LDA</span> <span class="token hex-number number">#$01</span> <span class="token punctuation">:</span> <span class="token op-code keyword">STA</span> csb_ram_time_visibility <span class="token comment">; Make timer visible</span>
    <span class="token op-code keyword">LDA</span> <span class="token hex-number number">#$3C</span> <span class="token punctuation">:</span> <span class="token op-code keyword">STA</span> csb_ram_time_frequency  <span class="token comment">; Decrease timer every real second</span></pre>
        </div>
        <p>
          then add the level in UberASMTool&#39;s <code>list.txt</code>, under
          the <code>level:</code> label
        </p>
        <div class="highlight highlight-source-uberasm notranslate">
          <pre>level:
<span class="token decimal-number number">105</span> <span class="token filename keyword">level_105.asm</span> <span class="token comment">; &lt;- Add this line</span></pre>
        </div>
        <p>
          In UberASM code almost every setting has a corresponding RAM address,
          that can be accessed with <code>csb_ram_&lt;setting_name&gt;</code>.
          The RAM address can also be found in the setting&#39;s description in
          <code>csb_asm/settings.asm</code>. To change a value we do
        </p>
        <div class="highlight highlight-source-asar notranslate">
          <pre><span class="token comment">;  value            RAM address</span>
<span class="token comment">;    v                   v</span>
<span class="token op-code keyword">LDA</span> <span class="token decimal-number number">#01</span> <span class="token punctuation">:</span> <span class="token op-code keyword">STA</span> csb_ram_time_visibility</pre>
        </div>
        <p>
          where <code>value</code> is any of the possible listed in the
          setting&#39;s description (always prefixed by a <code>#</code> and
          written with two digits), and <code>RAM address</code> is the name of
          the setting, prefixed by <code>csb_ram</code>.
        </p>
        <p>
          An example for a level file is provided under
          <code>asm/level/example.asm</code>.
        </p>
        <h2 id="3-using-ram-addresses-in-other-tools">
          <a
            class="anchor"
            aria-hidden="true"
            tabindex="-1"
            href="#3-using-ram-addresses-in-other-tools"
            ><svg
              class="octicon octicon-link"
              viewBox="0 0 16 16"
              width="16"
              height="16"
              aria-hidden="true"
            >
              <path
                fill-rule="evenodd"
                d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"
              ></path></svg></a
          >3. Using RAM addresses in other tools
        </h2>
        <p>
          You can also use RAM addresses outside of UberASMTool (<em>e.g.</em>,
          GPS), but in that case you first need to include their definitions.
        </p>
        <p>
          For instance, we can create a block that toggles the visibility of the
          status bar when hit from below
        </p>
        <div class="highlight highlight-source-asar notranslate">
          <pre><span class="token builtin function">db</span> <span class="token hex-number number">$42</span>
<span class="token op-code keyword">JMP</span> MarioBelow
<span class="token op-code keyword">JMP</span> Ignore <span class="token punctuation">:</span> <span class="token op-code keyword">JMP</span> Ignore <span class="token punctuation">:</span> <span class="token op-code keyword">JMP</span> Ignore
<span class="token op-code keyword">JMP</span> Ignore <span class="token punctuation">:</span> <span class="token op-code keyword">JMP</span> Ignore <span class="token punctuation">:</span> <span class="token op-code keyword">JMP</span> Ignore
<span class="token op-code keyword">JMP</span> Ignore <span class="token punctuation">:</span> <span class="token op-code keyword">JMP</span> Ignore <span class="token punctuation">:</span> <span class="token op-code keyword">JMP</span> Ignore

<span class="token comment">; Redefine RAM base address.</span>
<span class="token comment">; It has to be the same as the one in ram.asm!</span>
<span class="token define number">!freeram_address</span> = <span class="token hex-number number">$7FB700</span>

<span class="token comment">; Macro for generating addresses.</span>
<span class="token builtin function">macro</span> define_ram<span class="token punctuation">(</span>offset<span class="token punctuation">,</span> name<span class="token punctuation">)</span>
    <span class="token define number">!ram_</span>&lt;name> = <span class="token define number">!freeram_address</span>+&lt;offset>
    <span class="token builtin function">base</span> <span class="token define number">!ram_</span>&lt;name>
        ram_&lt;name><span class="token punctuation">:</span>
    <span class="token builtin function">base</span> off
<span class="token builtin function">endmacro</span>

<span class="token comment">; Define the addresses we need for the block.</span>
<span class="token comment">; Do not change the offset ($00)!</span>
<span class="token class-name">%define_ram</span><span class="token punctuation">(</span><span class="token hex-number number">$00</span><span class="token punctuation">,</span> status_bar_visibility<span class="token punctuation">)</span>

<span class="token comment">; Our code.</span>
MarioBelow<span class="token punctuation">:</span>
    <span class="token comment">; If visibility is 1 set it to 0, if it is 0 set it to 1.</span>
    <span class="token op-code keyword">LDA</span> ram_status_bar_visibility <span class="token punctuation">:</span> <span class="token op-code keyword">BEQ</span> +
    <span class="token op-code keyword">LDA</span> <span class="token hex-number number">#$00</span> <span class="token punctuation">:</span> <span class="token op-code keyword">STA</span> ram_status_bar_visibility <span class="token punctuation">:</span> <span class="token op-code keyword">RTL</span>
+   <span class="token op-code keyword">LDA</span> <span class="token hex-number number">#$01</span> <span class="token punctuation">:</span> <span class="token op-code keyword">STA</span> ram_status_bar_visibility <span class="token punctuation">:</span> <span class="token op-code keyword">RTL</span>

Ignore<span class="token punctuation">:</span>
    <span class="token op-code keyword">RTL</span>

<span class="token builtin function">print</span> <span class="token string">"Toggle status bar when hit from below"</span></pre>
        </div>
        <p>
          Alternatively, you can copy <code>ram.asm</code> and put it in the
          folder containing the block file(s) and include it
        </p>
        <div class="highlight highlight-source-asar notranslate">
          <pre><span class="token builtin function">db</span> <span class="token hex-number number">$42</span>
<span class="token op-code keyword">JMP</span> MarioBelow
<span class="token op-code keyword">JMP</span> Ignore <span class="token punctuation">:</span> <span class="token op-code keyword">JMP</span> Ignore <span class="token punctuation">:</span> <span class="token op-code keyword">JMP</span> Ignore
<span class="token op-code keyword">JMP</span> Ignore <span class="token punctuation">:</span> <span class="token op-code keyword">JMP</span> Ignore <span class="token punctuation">:</span> <span class="token op-code keyword">JMP</span> Ignore
<span class="token op-code keyword">JMP</span> Ignore <span class="token punctuation">:</span> <span class="token op-code keyword">JMP</span> Ignore <span class="token punctuation">:</span> <span class="token op-code keyword">JMP</span> Ignore

<span class="token comment">; Include the RAM file. Make sure !freeram_address has the correct address!</span>
<span class="token builtin function">incsrc</span> ram.asm

<span class="token comment">; Our code.</span>
MarioBelow<span class="token punctuation">:</span>
    <span class="token comment">; If visibility is 1 set it to 0, if it is 0 set it to 1.</span>
    <span class="token op-code keyword">LDA</span> ram_status_bar_visibility <span class="token punctuation">:</span> <span class="token op-code keyword">BEQ</span> +
    <span class="token op-code keyword">LDA</span> <span class="token hex-number number">#$00</span> <span class="token punctuation">:</span> <span class="token op-code keyword">STA</span> ram_status_bar_visibility <span class="token punctuation">:</span> <span class="token op-code keyword">RTL</span>
+   <span class="token op-code keyword">LDA</span> <span class="token hex-number number">#$01</span> <span class="token punctuation">:</span> <span class="token op-code keyword">STA</span> ram_status_bar_visibility <span class="token punctuation">:</span> <span class="token op-code keyword">RTL</span>

Ignore<span class="token punctuation">:</span>
    <span class="token op-code keyword">RTL</span>

<span class="token builtin function">print</span> <span class="token string">"Toggle status bar when hit from below"</span></pre>
        </div>
        <p>For more, check out <code>csb_asm/ram.asm</code>.</p>
        <h2 id="4-status-bar-tilemap-color-palette">
          <a
            class="anchor"
            aria-hidden="true"
            tabindex="-1"
            href="#4-status-bar-tilemap-color-palette"
            ><svg
              class="octicon octicon-link"
              viewBox="0 0 16 16"
              width="16"
              height="16"
              aria-hidden="true"
            >
              <path
                fill-rule="evenodd"
                d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"
              ></path></svg></a
          >4. Status bar tilemap color palette
        </h2>
        <p>
          The colors used for tiles of the status bar are defined in
          <code>csb_asm/colors.asm</code>. Please, refer to the explanation in
          the file to find out more.
        </p>
        <p>
          Also, I suggest you read
          <a
            href="https://www.smwcentral.net/?p=section&a=details&id=26018"
            rel="noopener noreferrer"
            >HammerBrother&#39;s Status Bar tutorial</a
          >.
        </p>
        <h2 id="5-event-callbacks">
          <a
            class="anchor"
            aria-hidden="true"
            tabindex="-1"
            href="#5-event-callbacks"
            ><svg
              class="octicon octicon-link"
              viewBox="0 0 16 16"
              width="16"
              height="16"
              aria-hidden="true"
            >
              <path
                fill-rule="evenodd"
                d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"
              ></path></svg></a
          >5. Event callbacks
        </h2>
        <p>
          You can specify your custom behaviors on specific events that are tied
          to the status bar. Currently, the following are supported:
        </p>
        <ul>
          <li>Bonus stars limit reached</li>
          <li>Coins limit reached</li>
          <li>Time run out</li>
        </ul>
        <p>
          To add custom behaviors, modify the contents of
          <code>csb_asm/callbacks.asm</code>.
        </p>
        <p>
          Let&#39;s take an example, we want to change the symbol in front of
          our bonus stars&#39; and coins&#39; indicators to a &quot;!&quot; when
          they reach the limit. To do so, add to the already defined routines in
          <code>csb_asm/callbacks.asm</code>
        </p>
        <div class="highlight highlight-source-asar notranslate">
          <pre>trigger_bonus_stars_limit_reached<span class="token punctuation">:</span>
    <span class="token op-code keyword">LDA</span> <span class="token hex-number number">#$28</span> <span class="token punctuation">:</span> <span class="token op-code keyword">STA</span> ram_bonus_stars_symbol <span class="token comment">; $28 is the "!" tile in GFX28</span>
    <span class="token op-code keyword">RTS</span>

trigger_coins_limit_reached<span class="token punctuation">:</span>
    <span class="token op-code keyword">LDA</span> <span class="token hex-number number">#$28</span> <span class="token punctuation">:</span> <span class="token op-code keyword">STA</span> ram_coins_symbol       <span class="token comment">; $28 is the "!" tile in GFX28</span>
    <span class="token op-code keyword">RTS</span></pre>
        </div>
        <p>
          Notice that since we are in CSB&#39;s namespace, in this file we
          don&#39;t have to prefix RAM addresses with <code>csb_</code>. In
          fact, we use <code>ram_coins_symbol</code> instead of
          <code>csb_ram_coins_symbol</code>.
        </p>
        <h2 id="6-base-ram-address">
          <a
            class="anchor"
            aria-hidden="true"
            tabindex="-1"
            href="#6-base-ram-address"
            ><svg
              class="octicon octicon-link"
              viewBox="0 0 16 16"
              width="16"
              height="16"
              aria-hidden="true"
            >
              <path
                fill-rule="evenodd"
                d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"
              ></path></svg></a
          >6. Base RAM address
        </h2>
        <p>
          This UberASM requires 34 bytes of contiguous free RAM. The base RAM
          address is specified in <code>csb_asm/ram.asm</code>, if you need to
          change it due to conflict with other custom code, you can modify it
          there.
        </p>
        <h2 id="7-custom-graphics">
          <a
            class="anchor"
            aria-hidden="true"
            tabindex="-1"
            href="#7-custom-graphics"
            ><svg
              class="octicon octicon-link"
              viewBox="0 0 16 16"
              width="16"
              height="16"
              aria-hidden="true"
            >
              <path
                fill-rule="evenodd"
                d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"
              ></path></svg></a
          >7. Custom graphics
        </h2>
        <p>
          The patch comes with a modified version of <code>GFX28.bin</code> that
          you can use. The changes are:
        </p>
        <ol>
          <li>Lower the clock tile (<code>$76</code>) by one pixel.</li>
          <li>
            Replace the first part of the &quot;TIME&quot; text
            (<code>$3D</code>) with an empty coin that can be used to display
            missing dragon coins (instead of a blank space).
          </li>
          <li>
            Replace the middle part of the &quot;TIME&quot; text
            (<code>$3E</code>) with a heart that can be used in front of the
            lives counter.
          </li>
          <li>
            Replace the last part of the &quot;TIME&quot; text
            (<code>$3F</code>) with a star that can be used in front of the
            bonus stars counter.
          </li>
          <li>
            Replace the corner of the item box (<code>$3A</code>) with a
            checkmark that can be used to mark when all dragon coins have been
            collected.
          </li>
          <li>
            Replace the top of the item box (<code>$3B</code>) with an
            alternative coin that can be used in front of the coins counter.
          </li>
        </ol>
        <p>Using the modified version is entirely <strong>optional</strong>.</p>
        <p>
          To use the modified version, simply replace the
          <code>Graphics/GFX28.bin</code> file in your ROM hack folder with
          <code>graphics/GFX28.bin</code> present in this bundle, then import
          graphics via Lunar Magic.
        </p>
        <p>
          Changing graphics doesn&#39;t require a rerun of UberASMTool. However,
          since <em>GFX28</em> is loaded on the title screen, you want to make
          sure you go through that to see changes (relevant if you&#39;re using
          save states).
        </p>
      </main>
    </div>
  </body>
</html>
