
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../assets/markdown.css">
  </head>
  <body>
    <div data-color-mode="light" data-light-theme="light" data-dark-theme="dark" class="markdown-body">
      <main>
        <div class="navigation"><a href="../../README.html">Home</a> | <a href="./changelog.html">Changelog</a> | <a href="./compatibility.html">Compatibility</a> | <a href="./credits.html">Credits</a> | <a href="./dynamic_positioning.html">Dynamic positioning</a> | <a href="./features.html">Features</a> | How to insert | <a href="./how_to_remove.html">How to remove</a> | <a href="./how_to_use.html">How to use</a></div>
        <h1 id="how-to-insert"><a class="anchor" aria-hidden="true" tabindex="-1" href="#how-to-insert"><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>How to insert</h1><p>Instructions for inserting CSB into your ROM hack via UberASMTool.</p>
<h2 id="1-instructions"><a class="anchor" aria-hidden="true" tabindex="-1" href="#1-instructions"><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>1. Instructions</h2><p>Follow these steps:</p>
<ol>
<li><p>Copy <code>asm/csb_asm/</code> inside UberASMTool&#39;s top folder (at the same level of
<code>gamemode/</code>, <code>levels/</code>, <code>library/</code>, <em>etc.</em>)</p>
</li>
<li><p>Copy <code>asm/library/csb.asm</code> inside UberASMTool&#39;s <code>library/</code> folder</p>
</li>
<li><p>Copy <code>asm/other/status.code</code> inside UberASMTool&#39;s <code>other/</code> folder (note that
the file already exists, you can replace it)</p>
</li>
<li><p>Copy <code>asm/gamemode/csb_gm11.asm</code> inside UberASMTool&#39;s <code>gamemode/</code> folder</p>
</li>
<li><p>Copy the following in UberASMTool&#39;s <code>list.txt</code>, under <code>gamemode:</code></p>
<div class="highlight highlight-source-asm6502 notranslate"><pre>gamemode<span class="token punctuation">:</span>
<span class="token decimal-number number">11</span> csb_gm11<span class="token directive property">.asm</span> <span class="token comment">; &lt;- Add this line</span></pre></div></li>
<li><p>Make sure you have edited at least one level in Lunar Magic</p>
</li>
<li><p>Run UberASMTool</p>
</li>
</ol>
<h2 id="2-clarifications"><a class="anchor" aria-hidden="true" tabindex="-1" href="#2-clarifications"><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>2. Clarifications</h2><p>Clarifications to problems that might arise when installing.</p>
<h3 id="13-what-if-i-previously-edited-uberasmtools-otherstatus_codeasm"><a class="anchor" aria-hidden="true" tabindex="-1" href="#13-what-if-i-previously-edited-uberasmtools-otherstatus_codeasm"><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>(1.3) What if I previously edited UberASMTool&#39;s <code>other/status_code.asm</code>?</h3><p>Instead of copying and replacing the file, you can just open UberASMTool&#39;s
<code>other/status_code.asm</code> and modify the <code>main:</code> label as follows</p>
<div class="highlight highlight-source-asm6502 notranslate"><pre>main<span class="token punctuation">:</span>
    ...          <span class="token comment">; Other stuff that you previously added</span>
    JSL csb_main <span class="token comment">; &lt;- Add this line</span>
    <span class="token op-code keyword">RTS</span></pre></div><h3 id="14-what-if-i-already-have-a-file-for-game-mode-11-gm11"><a class="anchor" aria-hidden="true" tabindex="-1" href="#14-what-if-i-already-have-a-file-for-game-mode-11-gm11"><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>(1.4) What if I already have a file for Game Mode 11 (GM11)?</h3><p>In this case, you have a couple of solutions. The first (and simplest) is to
call CSB&#39;s routine for GM11 inside the already existing GM11 file, under the
<code>init:</code> label. For instance, if you are using KevinM&#39;s Retry System, you can
modify <code>retry_gm11.asm</code> to look like this</p>
<div class="highlight highlight-source-asm6502 notranslate"><pre>init<span class="token punctuation">:</span>
    JSL retry_level_init_1_init
    JSL retry_level_transition_init
    JSL csb_reset_ram               <span class="token comment">; &lt;- Add this line</span>
    RTL</pre></div><p>With this method, you skip step (1.e) of the instructions.</p>
<p>As an alternative, you can create a common file that merges the two (or more)
GM11 files, as described on SMWCentral. For more about that, consult the
<a href="https://www.smwcentral.net/?p=faq&page=1515827-uberasm" rel="noopener noreferrer">FAQ</a>.</p>
<p>In our case, we need to create a <code>gm11.asm</code> file in UberASMTool&#39;s <code>gamemode/</code>
folder with the following content</p>
<div class="highlight highlight-source-asm6502 notranslate"><pre>macro call_library<span class="token punctuation">(</span>i<span class="token punctuation">)</span>
    PHB
    <span class="token op-code keyword">LDA</span><span class="token directive property">.b</span> #&lt;i>>><span class="token decimal-number number">16</span>
    <span class="token op-code keyword">PHA</span>
    PLB
    JSL &lt;i>
    PLB
endmacro

init<span class="token punctuation">:</span>
    %call_library<span class="token punctuation">(</span>other_gm11_init<span class="token punctuation">)</span> <span class="token comment">; Stuff from already existing GM11 file</span>
    JSL csb_reset_ram              <span class="token comment">; &lt;- Call to our library</span>
    RTL

main<span class="token punctuation">:</span>
    %call_library<span class="token punctuation">(</span>other_gm11_main<span class="token punctuation">)</span> <span class="token comment">; More stuff from already existing GM11 file</span>
    RTL</pre></div><p>In this case <code>other_gm11.asm</code> is the other GM11 file, that now we moved from
<code>gamemode/</code> folder to <code>library/</code> folder. It looks something like this</p>
<div class="highlight highlight-source-asm6502 notranslate"><pre>init<span class="token punctuation">:</span>
    ... <span class="token comment">; Some code</span>
    RTL

main<span class="token punctuation">:</span>
    ... <span class="token comment">; Some other code</span>
    RTL</pre></div><p>Also, notice that we don&#39;t need to move <code>csb_gm11.asm</code> in the <code>library/</code> folder,
since <code>csb_reset_ram</code> is already available in UberASM code. In fact, we don&#39;t
need &quot;csb_gm11.asm&quot; at all!</p>
<p>Now, in <code>list.txt</code>, under <code>gamemode:</code> label, we list the newly created file</p>
<div class="highlight highlight-source-asm6502 notranslate"><pre>gamemode<span class="token punctuation">:</span>
<span class="token decimal-number number">11</span> gm11<span class="token directive property">.asm</span> <span class="token comment">; &lt;- Add this line</span></pre></div>
      </main>
    </div>
  </body>
</html>
